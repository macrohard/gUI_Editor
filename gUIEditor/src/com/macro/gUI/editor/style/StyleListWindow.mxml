<?xml version="1.0" encoding="utf-8"?>
<s:Window xmlns:fx="http://ns.adobe.com/mxml/2009"
		  xmlns:s="library://ns.adobe.com/flex/spark"
		  xmlns:mx="library://ns.adobe.com/flex/mx"
		  width="800" height="600" creationComplete="creationCompleteHandler(event)"
		  showStatusBar="false" title="样式管理器">
	<fx:Script>
		<![CDATA[
			import com.macro.gUI.editor.project.ProjectManager;
			import com.macro.gUI.editor.project.StyleConfiguration;
			
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			
			import spark.events.GridEvent;
			
			
			[Bindable]
			private var styles:ArrayList;
			
			protected function creationCompleteHandler(event:FlexEvent):void
			{
				styles = new ArrayList();
				dataGrid.dataProvider = styles;
				
				var config:StyleConfiguration = ProjectManager.inst.styleConfig;
				for each (var xml:XML in config.configXML.item)
				{
					var data:Object = new Object();
					data.key = xml.@id.toString();
					data.font = xml.@font.toString();
					data.size = xml.@size.toString();
					data.color = xml.@color.toString();
					data.bold = xml.@bold.toString();
					data.italic = xml.@italic.toString();
					data.underline = xml.@underline.toString();
					data.align = xml.@align.toString();
					data.leftMargin = xml.@leftMargin.toString();
					data.rightMargin = xml.@rightMargin.toString();
					data.indent = xml.@indent.toString();
					data.blockIndent = xml.@blockIndent.toString();
					data.leading = xml.@leading.toString();
					data.kerning = xml.@kerning.toString();
					data.letterSpacing = xml.@letterSpacing.toString();
					data.multiline = (xml.@multiline.toString() == "true");
					data.wordWrap = (xml.@wordWrap.toString() == "true");
					data.maxChars = xml.@maxChars.toString();
					data.filters = xml.@filters.toString();
					
					styles.addItem(data);
				}
			}
			
			protected function itemDoubleClickHandler(e:GridEvent):void
			{
				if (e.rowIndex != -1)
				{
					var w:StyleEditor = new StyleEditor();
					w.init(this, e.rowIndex, styles.getItemAt(e.rowIndex));
					PopUpManager.addPopUp(w, this, true);
					PopUpManager.centerPopUp(w);
				}
			}
			
		]]>
	</fx:Script>
	<s:DataGrid id="dataGrid" x="0" y="0" width="100%" height="100%" doubleClickEnabled="true"
				gridDoubleClick="itemDoubleClickHandler(event)" rowHeight="50">
		<s:columns>
			<s:ArrayList>
				<s:GridColumn dataField="key" headerText="样式常量"/>
				<s:GridColumn headerText="预览" itemRenderer="com.macro.gUI.editor.style.PreviewCell"/>
			</s:ArrayList>
		</s:columns>
	</s:DataGrid>
</s:Window>
